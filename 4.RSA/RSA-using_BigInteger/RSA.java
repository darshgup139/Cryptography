//Rohit Siddheshwar
//6787
//RSA Algorithm using randomly generated prime numbers.

/*
* @author Rohit G Siddheshwar.
* Date : 17 - 9 - 2015.
*/

import java.util.Scanner;
import java.math.BigInteger;
import java.util.Random;

class RSA{

	public static void main(String[] args){

		Scanner sc = new Scanner(System.in);
		//Initial Display
		System.out.println("_______________________________________________\n");
		System.out.println("                      RSA                      ");
		System.out.println("_______________________________________________\n");

		System.out.print("Enter the number of bits to be included in a prime number ( < 2048) : ");
		int nob = sc.nextInt();
		sc.nextLine();
		System.out.println("_______________________________________________\n");
		System.out.print("Enter number to be encrypted : ");
		BigInteger m = new BigInteger(sc.nextLine());

		//Time Check
		long startTime = System.currentTimeMillis();
		/*-----------------------------------------START OF RSA-----------------------------------------*/
		Random rnd = new Random();
		BigInteger p = BigInteger.probablePrime(nob,rnd);//Generate p
		BigInteger q = BigInteger.probablePrime(nob,rnd);//Generate q
		BigInteger n = p.multiply(q);//get the value of n
		BigInteger phi = p.subtract(BigInteger.ONE);//phi = (p-1)
		phi = phi.multiply(q.subtract(BigInteger.ONE));//phi = phi*(q-1) ==> phi = (p-1)*(q-1)
		BigInteger e = BigInteger.probablePrime(nob,rnd);//e and n are coprime i.e. no common factors. Hence e can be any prime number < n
		BigInteger d = e.modInverse(phi);//(e*d)%phi = 1. Therefore d = inverse(e)

		//public key  : (e,n)
		//private key : (d,n)

		//Encryption
		BigInteger enc = m.modPow(e,n);	//encrypyed text = m^e mod n

		//Decryption
		BigInteger dec = enc.modPow(d,n);//decrypyed text = encryptedtext^d mod n

		/*------------------------------------------END OF RSA------------------------------------------*/

		System.out.println("_______________________________________________\n");
		System.out.println("P              : " + p.toString());
		System.out.println("\nQ              : " + q.toString());
		System.out.println("\nN              : " + n.toString());
		System.out.println("\nPHI            : " + phi.toString());
		System.out.println("\nE              : " + e.toString());
		System.out.println("\nD              : " + d.toString());
		System.out.println("_______________________________________________\n");
		System.out.println("Encrypted Text : " + enc.toString());
		System.out.println("_______________________________________________\n");
		System.out.println("Decrypted Text : " + dec.toString());
		System.out.println("_______________________________________________\n");

		long endTime   = System.currentTimeMillis();
		long totalTime = endTime - startTime;
		System.out.println("_______________________________________________\n");
		System.out.println("Execution Time : " + totalTime + " ms");
		System.out.println("_______________________________________________\n");
	}
}


/*


OUTPUT : 

1]For 32 bit prime numbers (p & q)

_______________________________________________

                      RSA                      
_______________________________________________

Enter the number of bits to be included in a prime number ( < 2048) : 32
_______________________________________________

Enter number to be encrypted : 6787
_______________________________________________

P              : 2566977139
Q              : 3768099403
N              : 9672625024980548017
PHI            : 9672625018645471476
E              : 3260687827
D              : 5756536144908590911
_______________________________________________

Encrypted Text : 6535504918956741225
_______________________________________________

Decrypted Text : 6787
_______________________________________________

_______________________________________________

Execution Time : 26 ms
_______________________________________________









2]For 1024 bit prime numbers (p & q)

_______________________________________________

                      RSA                      
_______________________________________________

Enter the number of bits to be included in a prime number ( < 2048) : 1024
_______________________________________________

Enter number to be encrypted : 9930777025
_______________________________________________

P              : 161921774311033945776502317572837316018328557034259526583948457347224033603929802933743927043897978643380974682545502304578437527633559600183087561549588553375335585803438404394286608751756722436609738126878766277453254228136228710872473423146468699219355628414928763730665515433473109499495449260227459882957

Q              : 148448084300691633052613831172265010737499679740054022208346850864557294450265094335287918107561248674298022841137317686599384015787969151029177379014790235322036539943631477321494238648739188039357411522664621555504206996033403846607974280853941086464582083066240282034836152807712454664245959601795512492279

N              : 24036977203041932053843233235931502554557751355851884592755982484089951588820205906500532512062662857070665492826003571637309921556536895609052793742586916957967969100219237553623882360287289148934389176442265289817817176234445499592523747623836382107635010997098892150747003277360164157431728090171313238523172540958088932172418295905595572376891885797906905129796093991709339037596091604246225769852708956134589658718825872524640764273929192637993453677094668688710501595104825367778942860779544992301930558212588472946262158300236463362844139643918984631070217439758266544904333265017395097525943862081612706189003

PHI            : 24036977203041932053843233235931502554557751355851884592755982484089951588820205906500532512062662857070665492826003571637309921556536895609052793742586916957967969100219237553623882360287289148934389176442265289817817176234445499592523747623836382107635010997098892150747003277360164157431728090171313238522862171099477206593589179756850470050136057561132591581003798683497557709541896706977193924701249728816910661195143052533462942730507663886781188736530289900013129469357755486063162013379049081825963408563045085113304697076066830805363691939918574845386279728277097499138831596776209533362202453219589733813768

E              : 159690501233271253647307969014753898742147151113859397432862955000882865848551392588651861948344151785727350175544768806778654827588812924686744949541387354467444181657984979857664430284155931887890908106478033363640787160418279964314984680530537606252858216280419264238460102544360511801842111366108635967451

D              : 22023303566747980364042502695537097236074975424534600611356505838959109237667254118277102172123711384313337248349666779290753407816818008362911365826039738961885543197521004486993275103213264347182080744487072333314510842387527330777631965048950394403805233068932109663429343790497462508398222027571666301788915934542696470884004624768956893829824094576489199354623114780883039425116979194961801715677266231427317670612369430186231182454675214284314644538182665698249465287587717521312542217018703235392143062871338387701196517357982233208456250411331516264986494229294370139910387486268915665507764442944591477057755
_______________________________________________

Encrypted Text : 11234261826590483120269545750308922861356706278020158070181069362120987606303907712144030756860770092335616543199092456428811058147571704032872885161377277893342176507379935736197323734709492388742154469861456385785627483083706676589936910265224372214806682783429531878757693090232927024171332814272623623877654251109312689063855283542914930328233822826335926015463081430916137506581912328714713499729354569155868310171570195094038143845091765891560954407766446939085038904090869068847938718979029673928421123704182537007030080307295493913004023717027854125119373050237859325870499473638949010069170692839867824574887
_______________________________________________

Decrypted Text : 9930777025
_______________________________________________

_______________________________________________

Execution Time : 769 ms
_______________________________________________







3]For 2048 bit prime numbers (p & q)

_______________________________________________

                      RSA                      
_______________________________________________

Enter the number of bits to be included in a prime number ( < 2048) : 2048
_______________________________________________

Enter number to be encrypted : 9930777025
_______________________________________________

P              : 26893891148779945239070405227896363310605511969325147420403412713026243129423790220194759190399873872232151050634936071993097564934015572839434204264120734419248219876071204070570912124264873495063357349134243265122036208171121661109777503499555993835041704842393111175676366162984973013342959028198420447128758787203695133343492023570128584047635452395973483588052311644531037442020464892844825177482416934480409882448619718154145437788858356433320832832516133705673516316392943523593243519154271719492509723972041210508797452632918786852324750150489982465831965107478973892204168498547048211138221627177902548523547

Q              : 23567856163633927238056938818610696887241850711175092739733723820887136777533952222370322035433253167623570388336584716801990829925163876089839372047348050110495995587150763085783748291302562325337999289983631919400774578687799219131505987002160885251995738441925496504764268925105281132887591654590481399512295244811985077874920969731726769922095137628230883244915057031028440323766902937096231280072012518431548920085474342059026886374671904760464973889656640334691070633522012232734034147262589117550093401600531305877421398893798240910983321971460548029902732131249111260452037781003792898498979327804366229436141

N              : 633831358274873352469977982386236085083200770070352799314988301207122550437426942723846027042049959065815434803907435380664118501086253886852467035246544407460201364064160933803935866235705479421855263871872138742999142529156944068083259437677608703585359501247840232303615010005967668856647221291589205124963965159743815286446141500415083839466120281191111318653689262317204074635987115306945256563040166009788162256435996617378470442905393215258233977084588038413179818733298059713773667771031896470955813703877261205121539034212884936629667904793839251667971029695416704876153773804758630252414646773279508200812441788484256299881096875267018795250503260627651553667814005318685425053999643327409342319913018916737369538111889888128271140189506997202112615757500887262367819896292270665759868577376374620032536738507392913505053483666670987001760211390890327620530472286331495244915661801412539224773314959684248434438983100942907257203501267226449673588647411588547380898416988229321298666834922283536872671499688491445206349940860823619217860283242669506029090925783123649644376611407209274164490440107784406814589664587554253530509566844467200356076631508391765311603890112520291448331957655026869176438829497241613509871312127

PHI            : 633831358274873352469977982386236085083200770070352799314988301207122550437426942723846027042049959065815434803907435380664118501086253886852467035246544407460201364064160933803935866235705479421855263871872138742999142529156944068083259437677608703585359501247840232303615010005967668856647221291589205124963965159743815286446141500415083839466120281191111318653689262317204074635987115306945256563040166009788162256435996617378470442905393215258233977084588038413179818733298059713773667771031896470955813703877261205121539034212884936629667904793839251667971029695416704876153773804758630252414646773279508200812391326736943886008619747922972288190305413264971053427653868182151511674092685584966777238687185789697513816672918367339476051794647817753183342181189418477838075680829048698603513916960807184212135381868275038320530672879812066121518927900388610741443434843047176637235221166324448970627084409001459532592342046910891576992282854233147818234677680998523176531584020860645739189069134915706931615042134061992294391138326729559004687959079139244835305119060950875604012024457294318408163162441367545977547061461981681014123347992940483328313323436269814781108155415281563363179301448747318335329192296286631241093352440

E              : 24940379515807451280383669563716780957067348782951078785763163110651787869757162007536860216127454952885905159441529393039806374016239101435383178424331978076410142038221907642692817127620203729433705224236352927492678782808413144740527032197854232893950895529503189834773127105761141131838155171541880489363656988198406831985486837518308114919244134197914701553301497107306636570274944896483921000035977460737747208388853529708554131862828171206177469035712756892066072124505437966277875127532907335125526863469262674432673354444437584679799563858248885267866471048793399719062381154833827265023925003754944508573877

D              : 113070173170717907455720842086067652918600362466810234058921161338382163665637669534887514397560175475343152601677228224466569220358998771869018396947162889796355279306702874213962581874202981169004194563597080367943319308268058333861250733457235818256293938979837206879333925792058841116555756678529523596972280607307426652648974772202558875551268965590768958005542005092769753297214228755424652847542093308101119447141481830071651845084278224316451826216420941329907271561767381758736173303787669279805040307850245730470311682502691021050499514790950010349663932821730737416491883931021673190830974898751720011470881028195010444189185617883472426187471061957036087558715310272799948647939021124041392525926979940260306105101521965555355680152169526774757681088818904283316524434770733047498252393222726598409842283409150060817284380090017488360143226688237172623061696361402209062864317314115760457183129022257920457985141761379774773213684991708745962348729322281227034444994302104937755662305571780496112798521102726575783591279349269549558203233995506863889547913801017866384469225223863951753837217364072692811880933409834864521405413457040944213996994791717284459435268362224436806317758002443350003322072639163446025175102853
_______________________________________________

Encrypted Text : 371711332697367370568366225113343742139378007221016693294630476249143136491843027074227373876490024332821827340728572548850005129812904015236414971692726732660529630535347196939778396916826767401508236643292762238743351179612953181944223627484049086053170208644390654984191420460467925383127772745460227857936073693364782637551958334320110056130107920343107372549985960796959638402813525400368180999023510856526868161531237993878473871778449331310022931678156836053419103124403680828662673435296742823564368357192224881729572177446541802403644199466489952265154222650689031358477393027344326462359134178975067357757517450127280077718971908547430337950402844997727885204952443762698123167272966386151667318701085089127971867946646525346796138902079944520389080647170876829331974702017727408807644011959650004823526315269419533912051500642978446996313228189831281274861206455182156991072526379332181018596284008419754763521003639123445513561954328722480991861180329944280128802678219441685296481716073899403226472834784127095886160571602963375119869667657044077603344732293097595144921678872233914189208208439737806906917965816211852463179814460417628132701895830200670648788979296947584630829465135581253555035082310331295490717454963
_______________________________________________

Decrypted Text : 9930777025
_______________________________________________

_______________________________________________

Execution Time : 6658 ms
_______________________________________________



*/